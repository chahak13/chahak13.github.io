<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-12-20 Tue 15:57 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PoC: Stackoverflow parser</title>
<meta name="author" content="Chahak Mehta" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="../style.css" type="text/css"/>
</head>
<body>
<div id="preamble" class="status">
<div id="updated">Updated: 2022-12-20 Tue 15:54</div>
<nav>
<a href="/">Home</a>
<a href="/blog/sitemap.html">Posts</a>
</nav>
</div>
<div id="content" class="content">
<header>
<h1 class="title">PoC: Stackoverflow parser</h1>
</header><p>
Load the <kbd>requests</kbd> and <kbd>BeautifulSoup</kbd> libraries that will be used for scraping the webpage.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b6a0ff;">import</span> sys
<span style="color: #b6a0ff;">import</span> re
<span style="color: #b6a0ff;">import</span> requests
<span style="color: #b6a0ff;">from</span> bs4 <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">BeautifulSoup</span> <span style="color: #b6a0ff;">as</span> bs
</pre>
</div>

<p>
As a proof of concept, we will grab a random stackoverflow question that has more than one answers, one accepted answer, and code as a part of the answer to try and cover the major cases (still need to check about images). One such example is - <a href="https://stackoverflow.com/questions/357307/how-to-call-a-parent-class-function-from-derived-class-function">https://stackoverflow.com/questions/357307/how-to-call-a-parent-class-function-from-derived-class-function</a>
</p>

<p>
We&rsquo;ll download the webpage for further scrutiny using the <code>requests.get</code> function and then parsing it using <code>BeautifulSoup</code>.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #00d3d0;">url</span> <span style="color: #b6a0ff;">=</span> sys.<span style="color: #00bcff; font-style: italic;">argv</span>[<span style="color: #00bcff;">1</span>]
<span style="color: #a8a8a8;"># url = "https://math.stackexchange.com/questions/1339709/how-to-derive-the-weak-form-of-the-pde"</span>
<span style="color: #00d3d0;">base_url</span> <span style="color: #b6a0ff;">=</span> url.<span style="color: #00bcff; font-style: italic;">split</span>(<span style="color: #79a8ff;">"/"</span>)[<span style="color: #00bcff;">2</span>]
<span style="color: #00d3d0;">response</span> <span style="color: #b6a0ff;">=</span> requests.<span style="color: #00bcff; font-style: italic;">get</span>(url)
<span style="color: #b6a0ff;">if</span> response.<span style="color: #00bcff; font-style: italic;">ok</span>:
    <span style="color: #00d3d0;">soup</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">bs</span>(response.<span style="color: #00bcff; font-style: italic;">text</span>, <span style="color: #ff9077;">features</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"html.parser"</span>)
</pre>
</div>

<p>
There are two main classes of objects that are of our interest - 1. Question and 2. Answers (with possibly an accepted marker). Looking at the source code tells us that there are <kbd>question</kbd> and <kbd>answer</kbd> properties that can be used to filter them out. We&rsquo;ll take a stab at finding the question first.
</p>

<p>
A point to note, we cannot directly search for <kbd>question-hyperlink</kbd> links because there are other questions on the page too, so we need to first extract the question header from where we can get the required title.
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>This piece of code helps us in extracting the title of the question along with a link to it.</label><pre class="src src-python" id="orgad97c95"><span style="color: #00d3d0;">question_header</span> <span style="color: #b6a0ff;">=</span> soup.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'id'</span>: <span style="color: #79a8ff;">'question-header'</span>})
<span style="color: #00d3d0;">question_title</span> <span style="color: #b6a0ff;">=</span> question_header.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'a'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'question-hyperlink'</span>}).<span style="color: #00bcff; font-style: italic;">text</span>.<span style="color: #00bcff; font-style: italic;">strip</span>()
<span style="color: #00d3d0;">question_link</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"https://</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">base_url</span><span style="color: #b6a0ff;">}{</span><span style="color: #ffffff; background-color: #000000;">question_header.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">find</span><span style="color: #ffffff; background-color: #000000;">(</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">a</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">, {</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">class</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">: </span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">question-hyperlink</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">}).</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">get</span><span style="color: #ffffff; background-color: #000000;">(</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">href</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">)</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>
<span style="color: #a8a8a8;"># print((question_title, question_link))</span>
</pre>
</div>

<p>
Now that we have the title and the link to the question, we parse for the question content.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>Parse the content of the question</label><pre class="src src-python" id="org45841ad"><span style="color: #00d3d0;">prog</span> <span style="color: #b6a0ff;">=</span> re.<span style="color: #00bcff; font-style: italic;">compile</span>(<span style="color: #79a8ff;">r"\&lt;a .*?\/a\&gt;"</span>)
<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">parse_post</span>(<span style="color: #00d3d0;">post_banner</span>):
    <span style="color: #00d3d0;">elements</span> <span style="color: #b6a0ff;">=</span> post_banner.<span style="color: #00bcff; font-style: italic;">find_all</span>(<span style="color: #ff9077;">recursive</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">False</span>)
    <span style="color: #00d3d0;">name_set</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">'p'</span>, <span style="color: #79a8ff;">'pre'</span>}
    <span style="color: #00d3d0;">full_post</span> <span style="color: #b6a0ff;">=</span> []
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">element</span> <span style="color: #b6a0ff;">in</span> elements:
        <span style="color: #b6a0ff;">if</span> element.<span style="color: #00bcff; font-style: italic;">name</span> <span style="color: #b6a0ff;">in</span> name_set:
            <span style="color: #b6a0ff;">if</span> element.<span style="color: #00bcff; font-style: italic;">name</span> <span style="color: #b6a0ff;">==</span> <span style="color: #79a8ff;">"p"</span>:
                <span style="color: #00d3d0;">post</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">str</span>(element)
                <span style="color: #00d3d0;">post</span> <span style="color: #b6a0ff;">=</span> post.<span style="color: #00bcff; font-style: italic;">removeprefix</span>(<span style="color: #79a8ff;">"&lt;p&gt;"</span>).<span style="color: #00bcff; font-style: italic;">removesuffix</span>(<span style="color: #79a8ff;">"&lt;/p&gt;"</span>)
                <span style="color: #a8a8a8;"># Wrap code blocks in ~</span>
                <span style="color: #00d3d0;">post</span> <span style="color: #b6a0ff;">=</span> post.<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"&lt;code&gt;"</span>, <span style="color: #79a8ff;">"~"</span>).<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"&lt;/code&gt;"</span>, <span style="color: #79a8ff;">"~"</span>)
                <span style="color: #a8a8a8;"># Wrap emphasis in /</span>
                <span style="color: #00d3d0;">post</span> <span style="color: #b6a0ff;">=</span> post.<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"&lt;em&gt;"</span>, <span style="color: #79a8ff;">"/"</span>).<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"&lt;/em&gt;"</span>, <span style="color: #79a8ff;">"/"</span>)
                <span style="color: #a8a8a8;"># Wrap bold in *</span>
                <span style="color: #00d3d0;">post</span> <span style="color: #b6a0ff;">=</span> post.<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"&lt;strong&gt;"</span>, <span style="color: #79a8ff;">"*"</span>).<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"&lt;/strong&gt;"</span>, <span style="color: #79a8ff;">"*"</span>)
                <span style="color: #a8a8a8;"># Change href links to org links</span>
                <span style="color: #00d3d0;">result</span> <span style="color: #b6a0ff;">=</span> prog.<span style="color: #00bcff; font-style: italic;">finditer</span>(post)
                <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">res</span> <span style="color: #b6a0ff;">in</span> result:
                    <span style="color: #00d3d0;">temp</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">bs</span>(res.<span style="color: #00bcff; font-style: italic;">group</span>(<span style="color: #00bcff;">0</span>), <span style="color: #ff9077;">features</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"html.parser"</span>)
                    <span style="color: #00d3d0;">href_link</span> <span style="color: #b6a0ff;">=</span> temp.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'a'</span>).<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">'href'</span>)
                    <span style="color: #00d3d0;">href_text</span> <span style="color: #b6a0ff;">=</span> temp.<span style="color: #00bcff; font-style: italic;">text</span>
                    <span style="color: #00d3d0;">post</span> <span style="color: #b6a0ff;">=</span> prog.<span style="color: #00bcff; font-style: italic;">sub</span>(<span style="color: #79a8ff;">f"[[</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">href_link</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">][</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">href_text</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">]]"</span>, post, <span style="color: #ff9077;">count</span><span style="color: #b6a0ff;">=</span><span style="color: #00bcff;">1</span>)
                full_post.<span style="color: #00bcff; font-style: italic;">append</span>(<span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">post</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>)
            <span style="color: #b6a0ff;">else</span>:
                <span style="color: #00d3d0;">codeblock</span> <span style="color: #b6a0ff;">=</span> element.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'code'</span>)
                <span style="color: #00d3d0;">lang</span> <span style="color: #b6a0ff;">=</span> codeblock.<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">'class'</span>, <span style="color: #79a8ff;">"lang-"</span>).<span style="color: #00bcff; font-style: italic;">rsplit</span>(<span style="color: #79a8ff;">'-'</span>)[<span style="color: #b6a0ff;">-</span><span style="color: #00bcff;">1</span>]
                <span style="color: #00d3d0;">begin_tag</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"#+begin_example </span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">lang</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>
                <span style="color: #00d3d0;">end_tag</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">"#+end_example"</span>
                <span style="color: #00d3d0;">code</span> <span style="color: #b6a0ff;">=</span> codeblock.<span style="color: #00bcff; font-style: italic;">text</span>
                full_post.<span style="color: #00bcff; font-style: italic;">append</span>(<span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">begin_tag</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">code</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">end_tag</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>)
    <span style="color: #00d3d0;">post_text</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">''</span>.<span style="color: #00bcff; font-style: italic;">join</span>(full_post)
    <span style="color: #b6a0ff;">return</span> post_text

<span style="color: #00d3d0;">question</span> <span style="color: #b6a0ff;">=</span> soup.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'id'</span>: <span style="color: #79a8ff;">'question'</span>})
<span style="color: #00d3d0;">post_banner</span> <span style="color: #b6a0ff;">=</span> question.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'s-prose'</span>})
<span style="color: #00d3d0;">question_text</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">parse_post</span>(post_banner)
<span style="color: #a8a8a8;"># print(question_text)</span>
</pre>
</div>

<p>
Each question also contains comments that can be really useful, so we will try to parse them too.
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Parse comments in the question</label><pre class="src src-python" id="org9746c23"><span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">parse_comments</span>(<span style="color: #00d3d0;">cell</span>):
    <span style="color: #00d3d0;">comments</span> <span style="color: #b6a0ff;">=</span> []
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">comment</span> <span style="color: #b6a0ff;">in</span> cell.<span style="color: #00bcff; font-style: italic;">find_all</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'comment-body'</span>}):
        <span style="color: #00d3d0;">comment_str</span> <span style="color: #b6a0ff;">=</span> comment.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'span'</span>).<span style="color: #00bcff; font-style: italic;">text</span>
        <span style="color: #b6a0ff;">try</span>:
            <span style="color: #00d3d0;">comment_user</span> <span style="color: #b6a0ff;">=</span> comment.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'a'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'comment-user'</span>}).<span style="color: #00bcff; font-style: italic;">text</span>
        <span style="color: #b6a0ff;">except</span>:
            <span style="color: #00d3d0;">comment_user</span> <span style="color: #b6a0ff;">=</span> comment.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'span'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'comment-user'</span>}).<span style="color: #00bcff; font-style: italic;">text</span>
        comments.<span style="color: #00bcff; font-style: italic;">append</span>(<span style="color: #79a8ff;">f"+ (/</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">comment_user</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">/) </span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">comment_str</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>)
    <span style="color: #00d3d0;">comments_text</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">'</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">'</span>.<span style="color: #00bcff; font-style: italic;">join</span>(comments)
    <span style="color: #b6a0ff;">return</span> comments_text

<span style="color: #00d3d0;">question_comments</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">parse_comments</span>(question)
<span style="color: #a8a8a8;"># print(question_comments)</span>
</pre>
</div>

<p>
We can now combine all the parts to create a complete org question string.
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Generate complete org string for the question</label><pre class="src src-python" id="org11227e1"><span style="color: #00d3d0;">question_org_str</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"* [[</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">question_link</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">][</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">question_title</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">]]</span><span style="color: #b6a0ff;">\n\n</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">question_text</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">Comments</span><span style="color: #b6a0ff;">\n</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">question_comments</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>
<span style="color: #a8a8a8;"># print(question_org_str)</span>
</pre>
</div>

<p>
Now that we have covered most of the question components, we will start parsing the answers.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Parse all answers to the post</label><pre class="src src-python" id="orgc05ab77"><span style="color: #00d3d0;">answers</span> <span style="color: #b6a0ff;">=</span> []
<span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">i</span>, <span style="color: #00d3d0;">answer</span> <span style="color: #b6a0ff;">in</span> <span style="color: #f78fe7;">enumerate</span>(soup.<span style="color: #00bcff; font-style: italic;">find_all</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'answer'</span>})):
    <span style="color: #00d3d0;">answer_post</span> <span style="color: #b6a0ff;">=</span> answer.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'post-layout'</span>})
    <span style="color: #00d3d0;">answer_cell</span> <span style="color: #b6a0ff;">=</span> answer_post.<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'answercell'</span>}).<span style="color: #00bcff; font-style: italic;">find</span>(<span style="color: #79a8ff;">'div'</span>, {<span style="color: #79a8ff;">'class'</span>: <span style="color: #79a8ff;">'s-prose'</span>})
    <span style="color: #00d3d0;">answer_str</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">parse_post</span>(answer_cell)
    <span style="color: #00d3d0;">answer_comments</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">parse_comments</span>(answer_post)
    answers.<span style="color: #00bcff; font-style: italic;">append</span>(<span style="color: #79a8ff;">f"** Answer </span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">i</span><span style="color: #b6a0ff; background-color: #000000;">+</span><span style="color: #00bcff; background-color: #000000;">1</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n\n</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">answer_str</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;"> Comments:</span><span style="color: #b6a0ff;">\n</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">answer_comments</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>)

<span style="color: #00d3d0;">answer_org_str</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">'</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">'</span>.<span style="color: #00bcff; font-style: italic;">join</span>(answers)
<span style="color: #a8a8a8;"># print(answer_org_str)</span>
</pre>
</div>

<p>
We now have all the required components to write an org file for the stackoverflow question now. Let&rsquo;s compile everything and write it to a file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Compile all the elements and write to an org file</label><pre class="src src-python" id="orga450205"><span style="color: #b6a0ff;">import</span> os

<span style="color: #00d3d0;">title_lowercase</span> <span style="color: #b6a0ff;">=</span> question_title.<span style="color: #00bcff; font-style: italic;">lower</span>()
<span style="color: #00d3d0;">filename</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">os.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">path</span><span style="color: #ffffff; background-color: #000000;">.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">dirname</span><span style="color: #ffffff; background-color: #000000;">(__file__)</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">/</span><span style="color: #b6a0ff;">{</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">_</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">join</span><span style="color: #ffffff; background-color: #000000;">(title_lowercase.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">split</span><span style="color: #ffffff; background-color: #000000;">()).</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">removesuffix</span><span style="color: #ffffff; background-color: #000000;">(</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">?</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">)</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">.org"</span>
<span style="color: #00d3d0;">full_file_str</span> <span style="color: #b6a0ff;">=</span> (<span style="color: #79a8ff;">f":PROPERTIES:</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>
                 <span style="color: #79a8ff;">f":ID: </span><span style="color: #b6a0ff;">{</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">-</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">join</span><span style="color: #ffffff; background-color: #000000;">(title_lowercase.</span><span style="color: #00bcff; background-color: #000000; font-style: italic;">split</span><span style="color: #ffffff; background-color: #000000;">())</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>
                 <span style="color: #79a8ff;">f":END:</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>
                 <span style="color: #79a8ff;">f"#+title: </span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">question_title</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n\n</span><span style="color: #79a8ff;">"</span>
                 <span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">question_org_str</span><span style="color: #b6a0ff;">}</span><span style="color: #b6a0ff;">\n</span><span style="color: #79a8ff;">"</span>
                 <span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">answer_org_str</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>)
<span style="color: #b6a0ff;">with</span> <span style="color: #f78fe7;">open</span>(<span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">filename</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>, <span style="color: #79a8ff;">"w"</span>) <span style="color: #b6a0ff;">as</span> f:
    f.<span style="color: #00bcff; font-style: italic;">write</span>(full_file_str)
</pre>
</div>

<p>
We can now create a bookmarklet that we can install in the browser. Then, we can just click on whatever stackoverflow page we want to save for future reference.
</p>

<pre class="example" id="org73563d4">
$.ajax({
    type: "POST",
    url: "/Users/cmehta/Documents/org/roam/org/stackoverflow_parser.py " + document.URL,
    crossdomain: true,
}).done(function() {
    alert("Saved to roam!");
});
</pre>
</div>
<div id="postamble" class="status">
<hr/>
<footer>
<div class="generated">
Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.6)
</div>
</footer>
</div>
</body>
</html>