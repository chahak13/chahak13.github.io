<!doctype html><html lang=en>
<head>
<title>Gaussian quadrature in scipy :: Musings</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Scipy has an gaussian quadrature integration built-in in the integrate module as the integrate.quadrature function.
import numpy as np from scipy import integrate A simple example of quadrature integration can be seen as follows, where we integrate the simple function \(f(x) = 2x\) from limits 0 to 2.
f = lambda x: 2*x print(&amp;quot;Quadrature integration:&amp;quot;, integrate.quadrature(f, 0, 2)) print(&amp;quot;Analytical solution:&amp;quot;, 2**2) A more complex function can also be passed to the quadrature function.">
<meta name=keywords content>
<meta name=robots content="noodp">
<link rel=canonical href=https://chahak13.github.io/posts/gaussian_quadrature_in_scipy/>
<link rel=stylesheet href=https://chahak13.github.io/assets/style.css>
<link rel=apple-touch-icon href=https://chahak13.github.io/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=https://chahak13.github.io/img/favicon/orange.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:creator content="[Chahak Mehta]">
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Gaussian quadrature in scipy">
<meta property="og:description" content="Scipy has an gaussian quadrature integration built-in in the integrate module as the integrate.quadrature function.
import numpy as np from scipy import integrate A simple example of quadrature integration can be seen as follows, where we integrate the simple function \(f(x) = 2x\) from limits 0 to 2.
f = lambda x: 2*x print(&amp;quot;Quadrature integration:&amp;quot;, integrate.quadrature(f, 0, 2)) print(&amp;quot;Analytical solution:&amp;quot;, 2**2) A more complex function can also be passed to the quadrature function.">
<meta property="og:url" content="https://chahak13.github.io/posts/gaussian_quadrature_in_scipy/">
<meta property="og:site_name" content="Musings">
<meta property="og:image" content="https://chahak13.github.io/img/favicon/orange.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2021-07-14 00:00:00 +0000 UTC">
</head>
<body class=orange>
<div class="container center headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
Musings
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/posts>Index</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/posts>Index</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=https://chahak13.github.io/posts/gaussian_quadrature_in_scipy/>Gaussian quadrature in scipy</a></h1>
<div class=post-meta>
<span class=post-date>
2021-07-14
</span>
<span class=post-author>:: [Chahak Mehta]</span>
</div>
<span class=post-tags>
#<a href=https://chahak13.github.io/tags/python/>python</a>&nbsp;
#<a href=https://chahak13.github.io/tags/maths/>maths</a>&nbsp;
</span>
<div class=post-content><div>
<p>Scipy has an gaussian quadrature integration built-in in the <code>integrate</code> module as the <code>integrate.quadrature</code> function.</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>import numpy as np
from scipy import integrate
</code></pre><p>A simple example of quadrature integration can be seen as follows, where we integrate the simple function \(f(x) = 2x\) from limits 0 to 2.</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>f = lambda x: 2*x

print(&quot;Quadrature integration:&quot;, integrate.quadrature(f, 0, 2))
print(&quot;Analytical solution:&quot;, 2**2)
</code></pre><p>A more complex function can also be passed to the <code>quadrature</code> function.</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>def func(x):
    return x**2 + 2*x + 3

a = 2
print(&quot;Quadrature integration:&quot;, integrate.quadrature(func, 0, 2))
print(&quot;Analytical solution:&quot;, a**3/3 + a**2 + 3*a)
</code></pre><p>Now, to take into consideration functions that are dependent on more than just the integrating variable.</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>def func_2(t, z):
    return z*t + z**2 + 2*t

a = 2
z = 2
print(&quot;Quadrature integration:&quot;, integrate.quadrature(func_2, 0, 2, args=(z,)))
print(&quot;Analytical solution:&quot;, z*a**2/2 + a*z**2 + a**2)
</code></pre><p>If the function to integrate depends on more variables and even other functions, then we can pass those functions as parameters to the integrating function and solve the quadrature integration.</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>def func_3(t, z, f1, f2):
    return f1(t) + z*t + f2(t)**2

f1 = lambda x: x**2
f2 = lambda x: x**3

a, z = 2, 2
print(&quot;Quadrature integration:&quot;, integrate.quadrature(func_3, 0, 2, args=(z, f1, f2)))
print(&quot;Analytical solution:&quot;, a**3/3 + z*a**2/2 + a**7/7)
</code></pre><p>Functions with vector output need to provide the <code>vec_func</code> argument as <code>True</code>.</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>def f(x):
    # print(&quot;x:&quot;, x)
    # print(&quot;z:&quot;, z)
    return z*x*2

z = np.array([2, 3])
integrate.quad_vec(f, 0, 2)
</code></pre><p>For fixed order Gaussian quadrature integration</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>f = lambda x, a: np.sin(np.kron(a, x)).reshape(-1, x.shape[0])
x = np.array([1,2,3])
a = np.array([1,2])
print(f(x, a).shape)
</code></pre><pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>np.kron(a, x)
</code></pre><p>:results:</p>
<p>Writing gaussian quadrature integration from scratch using numpy</p>
<pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>def norm_pdf(x, mu, sigma):
    mu, sigma = mu.reshape(-1, 1), sigma.reshape(-1, 1)
    x = x.reshape(-1, 1)
    variance = sigma**2
    numerator = x - mu
    denominator = 2 * variance
    pdf = ((1/(np.sqrt(2 * np.pi) * sigma)) * np.exp(-(numerator**2) / denominator))
    return pdf

</code></pre><pre tabindex=0><code class=language-jupyter-python data-lang=jupyter-python>def h_z(a, b, T_i, x, y, sigma_m2, delta_a, delta_b, indicator, n_time_samples=1000):
    mc_sum = np.zeros(x.shape)
    t = rng.uniform(0, T_i, size=n_time_samples)
    alpha = t/T_i
    mu_x = a.x + alpha * (b.x - a.x)
    mu_y = a.y + alpha * (b.y - a.y)
    sigma = np.sqrt(t * (1 - alpha) * sigma_m2
                    + (1 - alpha)**2 * (delta_a**2)
                    + (alpha**2) * (delta_b**2))

    pdf_x = norm_pdf(x, mu_x, sigma)
    pdf_y = norm_pdf(y, mu_y, sigma)
    mc_sum += indicator * pdf_x * pdf_y

    return mc_sum
</code></pre>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://chahak13.github.io/posts/mbsync/>
<span class=button__icon>←</span>
<span class=button__text>Mbsync</span>
</a>
</span>
<span class="button next">
<a href=https://chahak13.github.io/posts/status_bar_in_rust/>
<span class=button__text>Status bar in Rust</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=https://chahak13.github.io/assets/main.js></script>
<script src=https://chahak13.github.io/assets/prism.js></script>
</div>
</body>
</html>