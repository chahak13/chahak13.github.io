<!doctype html><html lang=en>
<head>
<title>Mail in emacs - mu4e :: Musings</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="mu4e (mu-for-emacs) is an e-mail client for GNU Emacs version 24.4 or higher, built on top of the mu(1) e-mail search engine. mu4e is optimized for quickly processing large amounts of e-mail.
 As taken from the manual, mu4e is an email interface for emacs. It is strictly an interface and doesn&amp;rsquo;t communicate with the email provider for getting mails. This part is delegated to other things like mbsync, offlineimap etc.">
<meta name=keywords content>
<meta name=robots content="noodp">
<link rel=canonical href=https://chahak13.github.io/posts/mail_in_emacs_mu4e/>
<link rel=stylesheet href=https://chahak13.github.io/assets/style.css>
<link rel=apple-touch-icon href=https://chahak13.github.io/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=https://chahak13.github.io/img/favicon/orange.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:creator content="[Chahak Mehta]">
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Mail in emacs - mu4e">
<meta property="og:description" content="mu4e (mu-for-emacs) is an e-mail client for GNU Emacs version 24.4 or higher, built on top of the mu(1) e-mail search engine. mu4e is optimized for quickly processing large amounts of e-mail.
 As taken from the manual, mu4e is an email interface for emacs. It is strictly an interface and doesn&amp;rsquo;t communicate with the email provider for getting mails. This part is delegated to other things like mbsync, offlineimap etc.">
<meta property="og:url" content="https://chahak13.github.io/posts/mail_in_emacs_mu4e/">
<meta property="og:site_name" content="Musings">
<meta property="og:image" content="https://chahak13.github.io/img/favicon/orange.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2021-05-30 00:00:00 +0000 UTC">
</head>
<body class=orange>
<div class="container full headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
Musings
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/posts>Index</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/posts>Index</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=https://chahak13.github.io/posts/mail_in_emacs_mu4e/>Mail in emacs - mu4e</a></h1>
<div class=post-meta>
<span class=post-date>
2021-05-30
</span>
<span class=post-author>:: [Chahak Mehta]</span>
</div>
<span class=post-tags>
#<a href=https://chahak13.github.io/tags/emacs/>emacs</a>&nbsp;
</span>
<div class=post-content><div>
<blockquote>
<p>mu4e (mu-for-emacs) is an e-mail client for GNU Emacs version 24.4 or
higher, built on top of the mu(1) e-mail search engine. mu4e is
optimized for quickly processing large amounts of e-mail.</p>
</blockquote>
<p>As taken from the manual, mu4e is an email interface for emacs. It is strictly an interface and doesn&rsquo;t communicate with the email provider for getting mails. This part is delegated to other things like <code>mbsync</code>, <code>offlineimap</code> etc. I use <a href=/posts/fetching_emails_mbsync/>Fetching emails - mbsync</a> for getting my mail periodically from gmail.</p>
<h2 id=installation>Installation<a href=#installation class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>mu4e comes along with the <code>mu</code> utility that can be downloaded directly from the OS&rsquo;s package manager. For Arch, this can be done via the AUR</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>paru -S mu
</code></pre></div><p>This installs the <code>mu</code> indexer and its mu4e interface for emacs.</p>
<h2 id=configuration>Configuration<a href=#configuration class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>First thing to use mu4e is to load it into emacs. Since mu4e is installed via the package manager, it needs to be loaded into emacs. This can be done via the <code>load-path</code> directive in use-package.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp>(use-package mu4e
  :load-path <span style=color:#e6db74>&#34;/usr/share/emacs/site-lisp/mu4e&#34;</span>)
</code></pre></div><p>This will load mu4e into emacs. We now need to configure mu4e to look at the right paths for loading all the emails. The first variable that we need to set is the mail directory where mu4e will look for mails.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp>(setq mu4e-maildir <span style=color:#e6db74>&#34;~/Mail&#34;</span>)
</code></pre></div><p>Now that mu4e knows where to look for all emails, we can start configuring other variables for our liking.</p>
<h3 id=retrieval-and-indexing-mails>Retrieval and indexing mails<a href=#retrieval-and-indexing-mails class=hanchor arialabel=Anchor>&#8983;</a> </h3>
<p>An important thing to note is that mu4e doesn&rsquo;t retrieve emails from the provider itself but it can call other utilities periodically to do so. This can be done by setting the following to variables.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp>(setq mu4e-get-mail-command <span style=color:#e6db74>&#34;mbsync -a&#34;</span>)
(setq mu4e-update-interval (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>60</span>))
</code></pre></div><p>Using these variables, mu4e uses the shell command set in the <code>mu4e-get-mail-command</code> variable every <code>mu4e-update-interval</code> seconds, which is set to 10 mins here. This can be changed as per requirement. To improve the indexing performace, I set the the <code>mu4e-index-lazy-check</code> variable to <code>t</code>. This variable tells the mu indexer to not update index for directories whose last modified time is not after the previous indexing. While this doesn&rsquo;t take into consideration changing/updating of messages, it handles addition and removal of messages. Since most of my operations don&rsquo;t involve changing emails in place, I&rsquo;m going to try and use this to see how it affects my flow.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp>(setq mu4e-index-lazy-check <span style=color:#66d9ef>t</span>)
</code></pre></div><h3 id=contexts>Contexts<a href=#contexts class=hanchor arialabel=Anchor>&#8983;</a> </h3>
<p>Contexts provide the useful ability to switch between various email accounts, based on the right context, or manually. Using this, we can dynamically switch between folders of different email accounts. An <code>mu4e-context</code> is a Lisp object with a few useful members:</p>
<ul>
<li><code>name</code>: The name of the context. e.g. work or private</li>
<li><code>vars</code>: An association-list of variable settings for this account.</li>
<li><code>match-func</code>: A function that takes a MSG message plist as argument and returns non-nil if this context matches the situation. mu4e uses the first context that matches.</li>
</ul>
<p>We can use these variables to set contexts in mu4e as follows:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp>(setq mu4e-contexts
      (<span style=color:#a6e22e>list</span>
       (make-mu4e-context
	   :name <span style=color:#e6db74>&#34;Private&#34;</span>
	   :match-func (lambda (msg)
			 (when msg
			   (string-prefix-p <span style=color:#e6db74>&#34;/chahakcr7&#34;</span> (mu4e-message-field msg :maildir))))
	   :vars
	   <span style=color:#f92672>&#39;</span>(
	     (user-mail-address <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;chahakcr7@gmail.com&#34;</span>)
	     (<span style=color:#a6e22e>user-full-name</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;Chahak&#34;</span>)
	     (mu4e-drafts-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakcr7/[Gmail]/Drafts&#34;</span>)
	     (mu4e-sent-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakcr7/[Gmail]/Sent Mail&#34;</span>)
	     (mu4e-refile-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakcr7/[Gmail]/All Mail&#34;</span>)
	     (mu4e-trash-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakcr7/[Gmail]/Trash&#34;</span>)
	     ))
       <span style=color:#75715e>;; Official Email</span>
       (make-mu4e-context
	:name <span style=color:#e6db74>&#34;Official&#34;</span>
	:match-func (lambda (msg)
		      (when msg
			(string-prefix-p <span style=color:#e6db74>&#34;/chahakmehta013&#34;</span> (mu4e-message-field msg :maildir))))
	:vars
	<span style=color:#f92672>&#39;</span>(
	  (user-mail-address <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;chahak.mehta013@gmail.com&#34;</span>)
	  (<span style=color:#a6e22e>user-full-name</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;Chahak Mehta&#34;</span>)
	  (mu4e-drafts-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakmehta013/[Gmail]/Drafts&#34;</span>)
	  (mu4e-sent-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakmehta013/[Gmail]/Sent Mail&#34;</span>)
	  (mu4e-refile-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakmehta013/[Gmail]/All Mail&#34;</span>)
	  (mu4e-trash-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakmehta013/[Gmail]/Trash&#34;</span>)
	  ))

       <span style=color:#75715e>;; UT Austin email</span>
       (make-mu4e-context
	:name <span style=color:#e6db74>&#34;UT Austin&#34;</span>
	:match-func (lambda (msg)
		      (when msg
			(string-prefix-p <span style=color:#e6db74>&#34;/chahakut&#34;</span> (mu4e-message-field msg :maildir))))
	:vars
	<span style=color:#f92672>&#39;</span>(
	  (user-mail-address <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;chahak@utexas.edu&#34;</span>)
	  (<span style=color:#a6e22e>user-full-name</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;Chahak Mehta&#34;</span>)
	  (mu4e-drafts-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakut/[Gmail]/Drafts&#34;</span>)
	  (mu4e-sent-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakut/[Gmail]/Sent Mail&#34;</span>)
	  (mu4e-refile-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakut/[Gmail]/All Mail&#34;</span>)
	  (mu4e-trash-folder <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/chahakut/[Gmail]/Trash&#34;</span>)
	  ))))
</code></pre></div>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://chahak13.github.io/posts/fetching_emails_mbsync/>
<span class=button__icon>←</span>
<span class=button__text>Fetching emails - mbsync</span>
</a>
</span>
<span class="button next">
<a href=https://chahak13.github.io/posts/monte_carlo_integration_wikipedia/>
<span class=button__text>Monte Carlo integration - Wikipedia</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=https://chahak13.github.io/assets/main.js></script>
<script src=https://chahak13.github.io/assets/prism.js></script>
</div>
</body>
</html>